window.onscroll=function(){document.getElementById("pageheader");var e=document.getElementById("nav");function i(e,i){-1==e.className.split(" ").indexOf(i)&&(e.className+=" "+i)}function t(e,i){var t,n;-1!=(n=(t=e.className.split(" ")).indexOf(i))&&(t.splice(n,1),e.className=t.join(" "))}300<=window.pageYOffset?(i(e,"fixed-header"),i(avatar,"small-avatar"),i(nav_ul,"small-nav")):(t(e,"fixed-header"),t(avatar,"small-avatar"),t(nav_ul,"small-nav"))},window.dispatchEvent(new Event("scroll")),window.addEventListener("load",function(){var e,i,t=(e=t||{},(i=function(){this.afterElement=!!window.getComputedStyle&&window.getComputedStyle(document.body,":after"),this.currentBreakpoint="",this.lastBreakpoint="",this.init()}).prototype={init:function(){this.afterElement&&this._resizeListener()},_resizeListener:function(){var e=this,i=function(){e.currentBreakpoint=e.afterElement.getPropertyValue("content").replace(/^["']|["']$/g,""),console.log("current: "+e.afterElement.getPropertyValue("content")),e.currentBreakpoint!==e.lastBreakpoint&&(window.dispatchEvent(new Event("breakpoint-change"),e.currentBreakpoint),e.lastBreakpoint=e.currentBreakpoint)};window.addEventListener("resize",i),window.addEventListener("orientationchange",i),i()}},e.mediaqueryListener=e.mediaqueryListener||new i,e);window.addEventListener("breakpoint-change",function(e,i){console.log("breakpoint: "+i)})});var resizeCanvas=function(t,n,e,o){var i=function(e,i){n.canvas.width=e,n.canvas.height=i,t.width=e,t.height=i,"function"==typeof o&&o(e,i)};e.fullSize?i(window.innerWidth,window.innerHeight):i(e.width,e.height)},IKRS=IKRS||{CREATOR:"Ikaros Kappler",DATE:"2013-11-27"};IKRS.Object=function(){},IKRS.Object.inherit=function(){},IKRS.Object.prototype={constructor:IKRS.Object,toString:function(){return"[IKRS.Object]"}},IKRS.Pair=function(e,i){this.a=e,this.b=i},IKRS.Pair.prototype.clone=function(){return new IKRS.Pair(this.a,this.b)},IKRS.TileAlign=function(e,i,t,n){IKRS.Object.call(this),this.tileType=e,this.edgeLength=i,this.position=t,this.angle=n},IKRS.TileAlign.prototype.createTile=function(){switch(this.tileType){case IKRS.Girih.TILE_TYPE_DECAGON:return new IKRS.Tile.Decagon(this.edgeLength,this.position.clone(),this.angle);case IKRS.Girih.TILE_TYPE_PENTAGON:return new IKRS.Tile.Pentagon(this.edgeLength,this.position.clone(),this.angle);case IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON:return new IKRS.Tile.IrregularHexagon(this.edgeLength,this.position.clone(),this.angle);case IKRS.Girih.TILE_TYPE_RHOMBUS:return new IKRS.Tile.Rhombus(this.edgeLength,this.position.clone(),this.angle);case IKRS.Girih.TILE_TYPE_BOW_TIE:return new IKRS.Tile.BowTie(this.edgeLength,this.position.clone(),this.angle);case IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS:return new IKRS.Tile.PenroseRhombus(this.edgeLength,this.position.clone(),this.angle);default:throw"Cannot create tiles from unknown tile types ("+this.tileType+")."}},IKRS.TileAlign.prototype.clone=function(){return new IKRS.TileAlign(this.tileType,this.edgeLength,this.position.clone(),this.angle)},IKRS.TileAlign.prototype.toString=function(){return"[TileAlign]=tileType="+this.tileType+", edgeLength="+this.edgeLength+", position="+this.position.toString()+", angle="+this.angle+"]"},IKRS.TileAlign.prototype.constructor=IKRS.TileAlign,IKRS.Point2=function(e,i){IKRS.Object.call(this),this.x=e,this.y=i},IKRS.Point2.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},IKRS.Point2.prototype.addXY=function(e,i){return this.x+=e,this.y+=i,this},IKRS.Point2.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},IKRS.Point2.prototype.set=function(e){return this.x=e.x,this.y=e.y,this},IKRS.Point2.prototype.setXY=function(e,i){this.x=e,this.y=i},IKRS.Point2.prototype.invert=function(){return this.x=-this.x,this.y=-this.y,this},IKRS.Point2.prototype.getDifference=function(e){return new IKRS.Point2(e.x-this.x,e.y-this.y)},IKRS.Point2.prototype.dotProduct=function(e){return this.x*e.x+this.y*e.y},IKRS.Point2.prototype.inRange=function(e,i){return this.distanceTo(e)<=i},IKRS.Point2.prototype.equals=function(e,i){return void 0===i&&(i=EPSILON),this.distanceTo(e)<=i},IKRS.Point2.prototype.length=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},IKRS.Point2.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},IKRS.Point2.prototype.multiplyScalar=function(e){return this.x*=e,this.y*=e,this},IKRS.Point2.prototype.scaleTowards=function(e,i){return this.computeDifference(e).multiplyScalar(i).add(this)},IKRS.Point2.prototype.computeDifference=function(e){return new IKRS.Point2(e.x-this.x,e.y-this.y)},IKRS.Point2.prototype.clone=function(){return new IKRS.Point2(this.x,this.y)},IKRS.Point2.prototype.rotate=function(e,i){var t=Math.cos(i),n=Math.sin(i),o=this.x-e.x,r=this.y-e.y;return this.x=t*o-n*r+e.x,this.y=n*o+t*r+e.y,this},IKRS.Point2.prototype.toString=function(){return"("+this.x+", "+this.y+")"},IKRS.Point2.prototype.constructor=IKRS.Point2,IKRS.Point2.ZERO_POINT=new IKRS.Point2(0,0),IKRS.Line2=function(e,i){IKRS.Object.call(this),this.pointA=e,this.pointB=i},IKRS.Line2.prototype.length=function(){return this.pointA.distanceTo(this.pointB)},IKRS.Line2.prototype.determinant=function(){return IKRS.Line2.determinant(this.pointA,this.pointB)},IKRS.Line2.prototype.dotProduct=function(e){this._cloneDeep().translate(this.pointA.clone().invert()),e._cloneDeep().translate(e.pointA.clone().invert());return this.pointB.dotProduct(e.pointB)},IKRS.Line2.prototype.isColinearWith=function(e,i){return this.isColinearWithPoint(e.pointA,i)&&this.isColinearWithPoint(e.pointB,i)},IKRS.Line2.prototype.isColinearWithPoint=function(e,i){var t=(this.pointA.y-this.pointB.y)*(this.pointA.x-e.x),n=(this.pointA.y-e.y)*(this.pointA.x-this.pointB.x);return Math.abs(t-n)<=i},IKRS.Line2.prototype.translate=function(e){this.pointA.add(e),this.pointB.add(e)},IKRS.Line2.prototype.equalEdgePoints=function(e){return this.pointA==e.pointA&&this.pointB==e.pointB||this.pointA==e.pointB&&this.pointB==e.pointA},IKRS.Line2.prototype.computeEdgeIntersection=function(e){var i=IKRS.Line2.determinant(this.pointB.clone().sub(this.pointA),e.pointA.clone().sub(e.pointB)),t=IKRS.Line2.determinant(e.pointA.clone().sub(this.pointA),e.pointA.clone().sub(e.pointB))/i,n=IKRS.Line2.determinant(this.pointB.clone().sub(this.pointA),e.pointA.clone().sub(this.pointA))/i;return t<0||n<0||1<t||1<n?null:this.pointA.clone().multiplyScalar(1-t).add(this.pointB.clone().multiplyScalar(t))},IKRS.Line2.prototype.computeLineIntersection=function(e){var i=this.pointB.y-this.pointA.y,t=this.pointA.x-this.pointB.x,n=i*this.pointA.x+t*this.pointA.y,o=e.pointB.y-e.pointA.y,r=e.pointA.x-e.pointB.x,I=o*e.pointA.x+r*e.pointA.y,l=i*r-o*t;return 0==l?null:new IKRS.Point2((r*n-t*I)/l,(i*I-o*n)/l)},IKRS.Line2.prototype.clone=function(){return new IKRS.Line2(this.pointA,this.pointB)},IKRS.Line2.prototype._cloneDeep=function(){return new IKRS.Line2(this.pointA.clone(),this.pointB.clone())},IKRS.Line2.prototype.toString=function(){return"{ "+this.pointA.toString()+", "+this.pointB.toString()+"}"},IKRS.Line2.prototype.constructor=IKRS.Line2,IKRS.Line2.determinant=function(e,i){return e.x*i.y-e.y*i.x},IKRS.Polygon=function(e){IKRS.Object.call(this),null!=e&&e&&void 0!==e||(e=[]),this.vertices=e},IKRS.Polygon.prototype.getVertexAt=function(e){return e<0?this.vertices[this.vertices.length-Math.abs(e)%this.vertices.length]:this.vertices[e%this.vertices.length]},IKRS.Polygon.prototype.getEdgeAt=function(e){return new IKRS.Line2(this.getVertexAt(e),this.getVertexAt(e+1))},IKRS.Polygon.prototype.hasEdge=function(e){for(var i=0;i<this.vertices.length;i++){if(new IKRS.Line2(this.vertices[i],this.getVertexAt(i+1)).equalEdgePoints(e))return!0}return!1},IKRS.Polygon.prototype.containsPoint=function(e){var i,t=0,n=!1;for(i=0,t=this.vertices.length-1;i<this.vertices.length;t=i++)vertI=this.getVertexAt(i),vertJ=this.getVertexAt(t),vertI.y>e.y!=vertJ.y>e.y&&e.x<(vertJ.x-vertI.x)*(e.y-vertI.y)/(vertJ.y-vertI.y)+vertI.x&&(n=!n);return n},IKRS.Polygon.prototype.locateContainedPolygonPoints=function(e){for(var i=[],t=0;t<e.vertices.length;t++)this.containsPoint(e.vertices[t])&&i.push(t);return i},IKRS.Polygon.prototype.computeIntersection=function(e){return 0==polyA._computeIntersectionTriangulation(e).length?[]:outerEdgePair},IKRS.Polygon.prototype._computeIntersectionTriangulation=function(e){var i=this._computeIntersectingEdgePolygons(e),t=new IKRS.Graph2(i.extendedA.vertices),n=new IKRS.Graph2(i.extendedB.vertices),o=t.triangulate(),r=n.triangulate(),I=(_computeExtendedGraphFromTriangleIntersection(this,o),_computeExtendedGraphFromTriangleIntersection(e,r),this._computeInnerIntersectionPointsFromTriangulation(o,r)),l=new IKRS.Graph2(I.elements).triangulate();return new IKRS.TriangleSet(l)},IKRS.Polygon.prototype._computeInnerIntersectionPointsFromTriangulation=function(e,i){var t=new IKRS.ArraySet;for(var n in e){var o=e[n];for(var r in t.addUnique(o.getPointA()),t.addUnique(o.getPointB()),t.addUnique(o.getPointC()),i){var I=i[r];o.computeTriangleIntersectionPoints(I,t)}}for(var r in i){I=i[r];t.addUnique(I.getPointA()),t.addUnique(I.getPointB()),t.addUnique(I.getPointC())}return t},IKRS.Polygon.prototype._computeIntersectingEdgePolygons=function(e){for(var i=new IKRS.ArraySet,t=new IKRS.ArraySet,n=[],o=[],r=new IKRS.ArraySet,I=[],l=[],s=0;s<this.vertices.length;s++){var h=new IKRS.Line2(this.vertices[s],this.getVertexAt(s+1));n[s]=[],r.add(this.vertices[s]),I[s]=new IKRS.LineOrderedPointSet2(h),I[s].add(this.vertices[s]);for(var a=0;a<e.vertices.length;a++){0==s&&r.add(e.vertices[a]);var R=new IKRS.Line2(e.vertices[a],e.getVertexAt(a+1)),E=h.computeEdgeIntersection(R);0==s&&(l[a]=new IKRS.LineOrderedPointSet2(R),l[a].add(e.vertices[a])),E?(n[s][a]=new IKRS.Pair(i.elements.length,t.elements.length),o.push(n[s][a]),I[s].add(E),l[a].add(E),r.add(E)):n[s][a]=!1}}for(var S=new IKRS.Polygon,T=0;T<this.vertices.length;T++)for(var K=0;K<I[T].elements.length;K++)S.vertices.push(I[T].elements[K]);var g=new IKRS.Polygon;for(T=0;T<e.vertices.length;T++)for(K=0;K<l[T].elements.length;K++)g.vertices.push(l[T].elements[K]);return{extendedA:S,extendedB:g,intersectionGraph:n,intersectionList:o,allPoints:r}},IKRS.Polygon.prototype.multiplyScalar=function(e){for(var i=0;i<this.vertices.length;i++)this.vertices[i].multiplyScalar(e);return this},IKRS.Polygon.prototype.translate=function(e){for(var i in this.vertices)this.vertices[i].add(e);return this},IKRS.Polygon.prototype.translateXY=function(e,i){for(var t=0;t<this.vertices.length;t++)this.vertices[t].addXY(e,i);return this},IKRS.Polygon._crossProduct=function(e,i,t){return(i.x-e.x)*(t.y-e.y)-(i.y-e.y)*(t.x-e.x)},IKRS.Polygon.prototype.computePolygonIntersection=function(e){this.vertices;for(var i=0;i<e.vertices.lengh;i++)for(var t=new IKRS2.Line2(this.getVertexAt(i),this.getVertexAt(i+1)),n=0;n<this.vertices.length;n++){var o=this.getVertexAt(n);IKRS.Polygon2._crossProduct(t.pointA,t.pointB,o)}return result},IKRS.Polygon.prototype.computeBoundingBox=function(){return IKRS.BoundingBox2.computeFromPoints(this.vertices)},IKRS.Polygon.prototype.addVertex=function(e){this.vertices.push(e)},IKRS.Polygon.prototype.constructor=IKRS.Polygon,IKRS.Circle=function(e,i){IKRS.Object.call(this),this.center=e,this.radius=i},IKRS.Circle.prototype.computeIntersectionPoints=function(e){return IKRS.Circle.computeIntersectionPoints(this,e)},IKRS.Circle.prototype.containsPoint=function(e){return this.center.distanceTo(e)<=this.radius},IKRS.Circle.computeIntersectionPoints=function(e,i){var t=e.center.distanceTo(i.center);if(t>e.radius+i.radius||e.radius+t<i.radius||i.radius+t<e.radius)return null;var n=e.center.distanceTo(i.center),o=.25*Math.sqrt((Math.pow(e.radius+i.radius,2)-Math.pow(n,2))*(Math.pow(n,2)-Math.pow(e.radius-i.radius,2))),r=.5*(i.center.x+e.center.x)+.5*(i.center.x-e.center.x)*(Math.pow(e.radius,2)-Math.pow(i.radius,2))/Math.pow(n,2),I=2*(i.center.y-e.center.y)*o/Math.pow(n,2),l=.5*(i.center.y+e.center.y)+.5*(i.center.y-e.center.y)*(Math.pow(e.radius,2)-Math.pow(i.radius,2))/Math.pow(n,2),s=-2*(i.center.x-e.center.x)*o/Math.pow(n,2),h=r+I,a=r-I,R=l+s,E=l-s;return{pointA:new IKRS.Point2(h,R),pointB:new IKRS.Point2(a,E)}},IKRS.Circle.prototype.toString=function(){return"[IKRS.Circle]={ center="+(this.center?this.center.toString():"null")+", radius="+this.radius+"}"},IKRS.Circle.prototype.constructor=IKRS.Circle,IKRS.BoundingBox2=function(e,i,t,n){IKRS.Object.call(this),this.xMin=e,this.xMax=i,this.yMin=t,this.yMax=n},IKRS.BoundingBox2.prototype=new IKRS.Object,IKRS.BoundingBox2.prototype.constructor=IKRS.BoundingBox2,IKRS.BoundingBox2.prototype.toString=function(){return"IKRS.BoundingBox2={ xMin: "+this.xMin+", xMax: "+this.xMax+", yMin: "+this.yMin+", yMax: "+this.yMax+", width: "+this.getWidth()+", height: "+this.getHeight()+" }"},IKRS.BoundingBox2.prototype.getXMax=function(){return this.xMax},IKRS.BoundingBox2.prototype.getXMin=function(){return this.xMin},IKRS.BoundingBox2.prototype.getYMax=function(){return this.yMax},IKRS.BoundingBox2.prototype.getYMin=function(){return this.yMin},IKRS.BoundingBox2.prototype.getWidth=function(){return this.xMax-this.xMin},IKRS.BoundingBox2.prototype.getHeight=function(){return this.yMax-this.yMin},IKRS.BoundingBox2.prototype.getLeftUpperPoint=function(){return new IKRS.Point2(this.xMin,this.yMin)},IKRS.BoundingBox2.prototype.getRightUpperPoint=function(){return new IKRS.Point2(this.xMax,this.yMin)},IKRS.BoundingBox2.prototype.getRightLowerPoint=function(){return new IKRS.Point2(this.xMax,this.yMax)},IKRS.BoundingBox2.prototype.getLeftLowerPoint=function(){return new IKRS.Point2(this.xMin,this.yMax)},IKRS.BoundingBox2.prototype.getCenterPoint=function(){return new IKRS.Point2(this.xMin+this.getWidth()/2,this.yMin+this.getHeight()/2)},IKRS.BoundingBox2.prototype.computeDiagonalLength=function(){return this.getLeftUpperPoint().distanceTo(this.getRightLowerPoint())},IKRS.BoundingBox2.prototype.computeBoundingTriangle=function(){var e=this.computeDiagonalLength(),i=this.getCenterPoint(),t=new IKRS.Point2(i.x-e,this.yMax),n=new IKRS.Point2(i.x+e,this.yMax),o=new IKRS.Line2(t,this.getLeftUpperPoint()),r=new IKRS.Line2(n,this.getRightUpperPoint());return new IKRS.Triangle(t,o.computeLineIntersection(r),n)},IKRS.BoundingBox2.prototype.computeUnion=function(e){return new IKRS.BoundingBox2(Math.min(this.xMin,e.xMin),Math.max(this.xMax,e.xMax),Math.min(this.yMin,e.yMin),Math.max(this.yMax,e.yMax))},IKRS.BoundingBox2.prototype._toString=function(){return"[IKRS.BoundingBox2]={ xMin="+this.xMin+", xMax="+this.xMax+", yMin="+this.yMin+", yMax="+this.yMax+", width="+this.getWidth()+", height="+this.getHeight()+" }"},IKRS.BoundingBox2.computeFromPoints=function(e){if(e||(e=[]),0==e.length)return new IKRS.BoundingBox2(0,0,0,0);for(var i=e[0].x,t=e[0].x,n=e[0].y,o=e[0].y,r=1;r<e.length;r++){var I=e[r];i=Math.min(i,I.x),t=Math.max(t,I.x),n=Math.min(n,I.y),o=Math.max(o,I.y)}return new IKRS.BoundingBox2(i,t,n,o)},IKRS.Tile=function(e,i,t,n){IKRS.Object.call(this),void 0===t&&(t=0),"unknown"==typeof n&&(n=IKRS.Girih.TILE_TYPE_UNKNOWN),this.size=e,this.position=i,this.angle=t,this.polygon=new IKRS.Polygon,this.innerTilePolygons=[],this.outerTilePolygons=[],this.imageProperties=null,this.tileType=n},IKRS.Tile.prototype.getInnerTilePolygonAt=function(e){return e<0?this.innerTilePolygons[this.innerTilePolygons.length-Math.abs(e)%this.innerTilePolygons.length]:this.innerTilePolygons[e%this.innerTilePolygons.length]},IKRS.Tile.prototype.getOuterTilePolygonAt=function(e){return e<0?this.outerTilePolygons[this.outerTilePolygons.length-Math.abs(e)%this.outerTilePolygons.length]:this.outerTilePolygons[e%this.outerTilePolygons.length]},IKRS.Tile.prototype.getTranslatedVertex=function(e){return this._translateVertex(this.polygon.getVertexAt(e))},IKRS.Tile.prototype.getVertexAt=function(e){return this.polygon.getVertexAt(e)},IKRS.Tile.prototype.containsPoint=function(e){var i,t=0,n=!1;for(i=0,t=this.polygon.vertices.length-1;i<this.polygon.vertices.length;t=i++)vertI=this.getTranslatedVertex(i),vertJ=this.getTranslatedVertex(t),vertI.y>e.y!=vertJ.y>e.y&&e.x<(vertJ.x-vertI.x)*(e.y-vertI.y)/(vertJ.y-vertI.y)+vertI.x&&(n=!n);return n},IKRS.Tile.prototype.locateEdgeAtPoint=function(e,i){if(0==this.polygon.vertices.length)return-1;for(var t=new IKRS.Point2(0,0),n=0,o=2*i,r=-1,I=0;I<this.polygon.vertices.length;I++){var l=this.getTranslatedVertex(I),s=this.getTranslatedVertex(I+1);t.x=l.x+(s.x-l.x)/2,t.y=l.y+(s.y-l.y)/2,(n=t.distanceTo(e))<=i&&(-1==r||n<o)&&(o=n,r=I)}return r},IKRS.Tile.prototype.locateAdjacentEdge=function(e,i,t){if(0==this.polygon.vertices.length)return-1;for(var n=-1,o=2*t+1,r=0;r<=this.polygon.vertices.length;r++){var I=this.getTranslatedVertex(r),l=this.getTranslatedVertex(r+1),s=(I.distanceTo(e)+l.distanceTo(i))/2;s<t&&(-1==n||-1!=n&&s<o)&&(n=r,o=s)}return n},IKRS.Tile.prototype.toSVG=function(e,i,t){var n=!1;void 0!==t&&t||(t=[],n=!0);for(var o=0;o<this.innerTilePolygons.length;o++)this._polygonToSVG(this.innerTilePolygons[o],e,i,t);return n?t:t.join("")},IKRS.Tile.prototype._polygonToSVG=function(e,i,t,n){var o;void 0!==i&&void 0!==i.indent&&n.push(i.indent),n.push('<polygon points="');for(var r=0;r<e.vertices.length;r++)o=this._translateVertex(e.getVertexAt(r)),0<r&&n.push(" "),n.push(o.x),n.push(","),n.push(o.y);n.push('"'),void 0!==t&&(n.push(' style="'),n.push(t),n.push('"')),n.push(" />\n")},IKRS.Tile.prototype.computeBounds=function(){return IKRS.BoundingBox2.computeFromPoints(this.polygon.vertices)},IKRS.Tile.prototype._translateVertex=function(e){return e.clone().rotate(IKRS.Point2.ZERO_POINT,this.angle).add(this.position)},IKRS.Tile.prototype._addVertex=function(e){this.polygon.vertices.push(e)},IKRS.Tile.prototype.constructor=IKRS.Tile,IKRS.Tile.Decagon=function(e,i,t){IKRS.Tile.call(this,e,i,t,IKRS.Girih.TILE_TYPE_DECAGON);var n=new IKRS.Point2(0,0),o=n;this._addVertex(o);for(var r=Math.PI/2*.4,I=1;I<=9;I++)(o=(n=o).clone()).x+=e,o.rotate(n,I*r),this._addVertex(o);var l=IKRS.BoundingBox2.computeFromPoints(this.polygon.vertices),s=new IKRS.Point2(e/2,-l.getHeight()/2);for(I=0;I<this.polygon.vertices.length;I++)this.polygon.vertices[I].add(s);this.imageProperties={source:{x:.338,y:140/460,width:.626,height:297/460},destination:{xOffset:0,yOffset:0}},this._buildInnerPolygons(e),this._buildOuterPolygons()},IKRS.Tile.Decagon.prototype._buildInnerPolygons=function(e){for(var i=new IKRS.Polygon,t=0;t<10;t++){var n=new IKRS.Polygon,o=this.getVertexAt(t).clone().scaleTowards(this.getVertexAt(t+1),.5),r=o.clone().multiplyScalar(.615),I=this.getVertexAt(t).clone().multiplyScalar(.69),l=this.getVertexAt(t+1).clone().multiplyScalar(.69);n.addVertex(o),n.addVertex(l),n.addVertex(r),n.addVertex(I),this.innerTilePolygons.push(n),i.addVertex(I.clone()),i.addVertex(r.clone())}this.innerTilePolygons.push(i)},IKRS.Tile.Decagon.prototype._buildOuterPolygons=function(e){for(var i=0;i<10;i++){var t=new IKRS.Polygon;t.addVertex(this.getVertexAt(i).clone()),t.addVertex(this.innerTilePolygons[i].getVertexAt(0).clone()),t.addVertex(this.innerTilePolygons[i].getVertexAt(3).clone()),t.addVertex(this.getInnerTilePolygonAt(0==i?9:i-1).getVertexAt(0).clone()),this.outerTilePolygons.push(t)}},IKRS.Tile.Decagon.prototype.computeBounds=IKRS.Tile.prototype.computeBounds,IKRS.Tile.Decagon.prototype._addVertex=IKRS.Tile.prototype._addVertex,IKRS.Tile.Decagon.prototype._translateVertex=IKRS.Tile.prototype._translateVertex,IKRS.Tile.Decagon.prototype._polygonToSVG=IKRS.Tile.prototype._polygonToSVG,IKRS.Tile.Decagon.prototype.getInnerTilePolygonAt=IKRS.Tile.prototype.getInnerTilePolygonAt,IKRS.Tile.Decagon.prototype.getOuterTilePolygonAt=IKRS.Tile.prototype.getOuterTilePolygonAt,IKRS.Tile.Decagon.prototype.getTranslatedVertex=IKRS.Tile.prototype.getTranslatedVertex,IKRS.Tile.Decagon.prototype.containsPoint=IKRS.Tile.prototype.containsPoint,IKRS.Tile.Decagon.prototype.locateEdgeAtPoint=IKRS.Tile.prototype.locateEdgeAtPoint,IKRS.Tile.Decagon.prototype.locateAdjacentEdge=IKRS.Tile.prototype.locateAdjacentEdge,IKRS.Tile.Decagon.prototype.getVertexAt=IKRS.Tile.prototype.getVertexAt,IKRS.Tile.Decagon.prototype.toSVG=IKRS.Tile.prototype.toSVG,IKRS.Tile.Decagon.prototype.constructor=IKRS.Tile.Decagon,IKRS.Tile.Pentagon=function(e,i,t){IKRS.Tile.call(this,e,i,t,IKRS.Girih.TILE_TYPE_PENTAGON);var n=new IKRS.Point2(0,0),o=n;this._addVertex(o);for(var r=2*Math.PI/5,I=1;I<=4;I++)(o=(n=o).clone()).x+=e,o.rotate(n,I*r),this._addVertex(o);var l=e/10*Math.sqrt(50+10*Math.sqrt(5)),s=e/10*Math.sqrt(25+10*Math.sqrt(5)),h=new IKRS.Point2(e/2,l-s-l);for(I=0;I<this.polygon.vertices.length;I++)this.polygon.vertices[I].add(h);this.imageProperties={source:{x:.014,y:288/460,width:.314,height:165/460},destination:{xOffset:0,yOffset:-18/460}},this._buildInnerPolygons(e),this._buildOuterPolygons()},IKRS.Tile.Pentagon.prototype._buildInnerPolygons=function(e){for(var i=new IKRS.Polygon,t=new IKRS.Point2(0,0),n=0;n<this.polygon.vertices.length;n++)i.addVertex(this.getVertexAt(n).scaleTowards(this.getVertexAt(n+1),.5)),i.addVertex(this.getVertexAt(n+1).scaleTowards(t,.5));this.innerTilePolygons.push(i)},IKRS.Tile.Pentagon.prototype._buildOuterPolygons=function(){for(var e=0;e<this.polygon.vertices.length;e++){var i=e,t=2*e,n=new IKRS.Polygon;n.addVertex(this.getVertexAt(i+1).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(t).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(t+1).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(t+2).clone()),this.outerTilePolygons.push(n)}},IKRS.Tile.Pentagon.prototype.computeBounds=IKRS.Tile.prototype.computeBounds,IKRS.Tile.Pentagon.prototype._addVertex=IKRS.Tile.prototype._addVertex,IKRS.Tile.Pentagon.prototype._translateVertex=IKRS.Tile.prototype._translateVertex,IKRS.Tile.Pentagon.prototype._polygonToSVG=IKRS.Tile.prototype._polygonToSVG,IKRS.Tile.Pentagon.prototype.getInnerTilePolygonAt=IKRS.Tile.prototype.getInnerTilePolygonAt,IKRS.Tile.Pentagon.prototype.getOuterTilePolygonAt=IKRS.Tile.prototype.getOuterTilePolygonAt,IKRS.Tile.Pentagon.prototype.getTranslatedVertex=IKRS.Tile.prototype.getTranslatedVertex,IKRS.Tile.Pentagon.prototype.containsPoint=IKRS.Tile.prototype.containsPoint,IKRS.Tile.Pentagon.prototype.locateEdgeAtPoint=IKRS.Tile.prototype.locateEdgeAtPoint,IKRS.Tile.Pentagon.prototype.locateAdjacentEdge=IKRS.Tile.prototype.locateAdjacentEdge,IKRS.Tile.Pentagon.prototype.getVertexAt=IKRS.Tile.prototype.getVertexAt,IKRS.Tile.Pentagon.prototype.toSVG=IKRS.Tile.prototype.toSVG,IKRS.Tile.Pentagon.prototype.constructor=IKRS.Tile.Pentagon,IKRS.Tile.IrregularHexagon=function(e,i,t){IKRS.Tile.call(this,e,i,t,IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON);var n=new IKRS.Point2(0,0),o=n,r=n,I=null;this._addVertex(o);for(var l=[0,72,144,144,72],s=0,h=0;h<l.length;h++)s+=180-l[h],(o=(n=o).clone()).x-=e,o.rotate(n,s*(Math.PI/180)),this._addVertex(o),2==h&&(I=o);IKRS.BoundingBox2.computeFromPoints(this.polygon.vertices);var a=new IKRS.Point2((I.x-r.x)/2,(I.y-r.y)/2);for(h=0;h<this.polygon.vertices.length;h++)this.polygon.vertices[h].sub(a);this.imageProperties={source:{x:.154,y:11/460,width:.41,height:150/460},destination:{xOffset:0,yOffset:0}},this._buildInnerPolygons(),this._buildOuterPolygons()},IKRS.Tile.IrregularHexagon.prototype._buildInnerPolygons=function(){var e=new IKRS.Polygon;e.addVertex(this.polygon.vertices[0].scaleTowards(this.polygon.vertices[1],.5)),e.addVertex(this.polygon.vertices[1].scaleTowards(this.polygon.vertices[2],.5));var i=new IKRS.Circle(e.vertices[1],e.vertices[0].distanceTo(e.vertices[1])),t=new IKRS.Circle(this.polygon.vertices[2].clone().scaleTowards(this.polygon.vertices[3],.5),i.radius),n=i.computeIntersectionPoints(t);n&&void 0!==n?n.pointA.length()<n.pointB.length()?e.addVertex(n.pointA):e.addVertex(n.pointB):console.log("intersection is null!"),e.addVertex(t.center);i.center=t.center,t.center=this.polygon.vertices[3].clone().scaleTowards(this.polygon.vertices[4],.5),(n=i.computeIntersectionPoints(t))&&void 0!==n?n.pointA.length()<n.pointB.length()?e.addVertex(n.pointA):e.addVertex(n.pointB):console.log("intersection is null!"),e.addVertex(t.center),e.addVertex(this.polygon.vertices[4].clone().scaleTowards(this.polygon.vertices[5],.5)),i.center=e.vertices[e.vertices.length-1],t.center=this.polygon.vertices[5].clone().scaleTowards(this.polygon.vertices[0],.5),(n=i.computeIntersectionPoints(t))&&void 0!==n?n.pointA.length()<n.pointB.length()?e.addVertex(n.pointA):e.addVertex(n.pointB):console.log("intersection is null!"),e.addVertex(t.center),i.center=e.vertices[e.vertices.length-1],t.center=e.vertices[0],(n=i.computeIntersectionPoints(t))?n.pointA.length()<n.pointB.length()?e.addVertex(n.pointA):e.addVertex(n.pointB):console.log("intersection is null!"),e.addVertex(t.center),this.innerTilePolygons.push(e)},IKRS.Tile.IrregularHexagon.prototype._buildOuterPolygons=function(){for(var e=[0,3],i=[0,5],t=0;t<e.length;t++){var n,o=e[t],r=i[t],I=new IKRS.Polygon;I.addVertex(this.getVertexAt(o+1).clone()),I.addVertex(this.innerTilePolygons[0].getVertexAt(r).clone()),I.addVertex(this.innerTilePolygons[0].getVertexAt(r+1).clone()),this.outerTilePolygons.push(I),(n=new IKRS.Polygon).addVertex(this.getVertexAt(o+2).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(r+1).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(r+2).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(r+3).clone()),this.outerTilePolygons.push(n),(n=new IKRS.Polygon).addVertex(this.getVertexAt(o+3).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(r+3).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(r+4).clone()),n.addVertex(this.innerTilePolygons[0].getVertexAt(r+5).clone()),this.outerTilePolygons.push(n)}},IKRS.Tile.IrregularHexagon.prototype.computeBounds=IKRS.Tile.prototype.computeBounds,IKRS.Tile.IrregularHexagon.prototype._addVertex=IKRS.Tile.prototype._addVertex,IKRS.Tile.IrregularHexagon.prototype._translateVertex=IKRS.Tile.prototype._translateVertex,IKRS.Tile.IrregularHexagon.prototype._polygonToSVG=IKRS.Tile.prototype._polygonToSVG,IKRS.Tile.IrregularHexagon.prototype.getInnerTilePolygonAt=IKRS.Tile.prototype.getInnerTilePolygonAt,IKRS.Tile.IrregularHexagon.prototype.getOuterTilePolygonAt=IKRS.Tile.prototype.getOuterTilePolygonAt,IKRS.Tile.IrregularHexagon.prototype.getTranslatedVertex=IKRS.Tile.prototype.getTranslatedVertex,IKRS.Tile.IrregularHexagon.prototype.containsPoint=IKRS.Tile.prototype.containsPoint,IKRS.Tile.IrregularHexagon.prototype.locateEdgeAtPoint=IKRS.Tile.prototype.locateEdgeAtPoint,IKRS.Tile.IrregularHexagon.prototype.locateAdjacentEdge=IKRS.Tile.prototype.locateAdjacentEdge,IKRS.Tile.IrregularHexagon.prototype.getVertexAt=IKRS.Tile.prototype.getVertexAt,IKRS.Tile.IrregularHexagon.prototype.toSVG=IKRS.Tile.prototype.toSVG,IKRS.Tile.IrregularHexagon.prototype.constructor=IKRS.Tile.IrregularHexagon,IKRS.Tile.Rhombus=function(e,i,t){IKRS.Tile.call(this,e,i,t,IKRS.Girih.TILE_TYPE_RHOMBUS);var n=new IKRS.Point2(0,0),o=n;this._addVertex(o);for(var r=[0,72,108],I=0,l=0;l<r.length;l++)I+=180-r[l],(o=(n=o).clone()).x+=e,o.rotate(n,I*(Math.PI/180)),this._addVertex(o);var s=IKRS.BoundingBox2.computeFromPoints(this.polygon.vertices),h=new IKRS.Point2(s.getWidth()/2-(s.getWidth()-e),s.getHeight()/2);for(l=0;l<this.polygon.vertices.length;l++)this.polygon.vertices[l].add(h);this.imageProperties={source:{x:.064,y:188/460,width:.254,height:.2},destination:{xOffset:0,yOffset:0}},this._buildInnerPolygons(),this._buildOuterPolygons()},IKRS.Tile.Rhombus.prototype._buildInnerPolygons=function(){var e=new IKRS.Polygon;e.addVertex(this.polygon.vertices[0].scaleTowards(this.polygon.vertices[1],.5)),e.addVertex(this.polygon.vertices[1].scaleTowards(this.polygon.vertices[2],.5));var i=new IKRS.Circle(e.vertices[1],.73*e.vertices[0].distanceTo(e.vertices[1])),t=new IKRS.Circle(this.polygon.vertices[2].scaleTowards(this.polygon.vertices[3],.5),i.radius),n=i.computeIntersectionPoints(t);this.containsPoint(n.pointA)?e.addVertex(n.pointA):e.addVertex(n.pointB),e.addVertex(t.center),e.addVertex(this.polygon.vertices[3].scaleTowards(this.polygon.vertices[0],.5)),i.center=e.vertices[4],t.center=e.vertices[0],n=i.computeIntersectionPoints(t),this.containsPoint(n.pointA)?e.addVertex(n.pointA):e.addVertex(n.pointB),this.innerTilePolygons.push(e)},IKRS.Tile.Rhombus.prototype._buildOuterPolygons=function(){for(var e=[0,2],i=[0,3],t=0;t<e.length;t++){var n=e[t],o=i[t],r=new IKRS.Polygon;r.addVertex(this.getVertexAt(n+1).clone()),r.addVertex(this.innerTilePolygons[0].getVertexAt(o).clone()),r.addVertex(this.innerTilePolygons[0].getVertexAt(o+1).clone()),this.outerTilePolygons.push(r);var I=new IKRS.Polygon;I.addVertex(this.getVertexAt(n+2).clone()),I.addVertex(this.innerTilePolygons[0].getVertexAt(o+1).clone()),I.addVertex(this.innerTilePolygons[0].getVertexAt(o+2).clone()),I.addVertex(this.innerTilePolygons[0].getVertexAt(o+3).clone()),this.outerTilePolygons.push(I)}},IKRS.Tile.Rhombus.prototype.computeBounds=IKRS.Tile.prototype.computeBounds,IKRS.Tile.Rhombus.prototype._addVertex=IKRS.Tile.prototype._addVertex,IKRS.Tile.Rhombus.prototype._translateVertex=IKRS.Tile.prototype._translateVertex,IKRS.Tile.Rhombus.prototype._polygonToSVG=IKRS.Tile.prototype._polygonToSVG,IKRS.Tile.Rhombus.prototype.getInnerTilePolygonAt=IKRS.Tile.prototype.getInnerTilePolygonAt,IKRS.Tile.Rhombus.prototype.getOuterTilePolygonAt=IKRS.Tile.prototype.getOuterTilePolygonAt,IKRS.Tile.Rhombus.prototype.getTranslatedVertex=IKRS.Tile.prototype.getTranslatedVertex,IKRS.Tile.Rhombus.prototype.containsPoint=IKRS.Tile.prototype.containsPoint,IKRS.Tile.Rhombus.prototype.locateEdgeAtPoint=IKRS.Tile.prototype.locateEdgeAtPoint,IKRS.Tile.Rhombus.prototype.locateAdjacentEdge=IKRS.Tile.prototype.locateAdjacentEdge,IKRS.Tile.Rhombus.prototype.getVertexAt=IKRS.Tile.prototype.getVertexAt,IKRS.Tile.Rhombus.prototype.toSVG=IKRS.Tile.prototype.toSVG,IKRS.Tile.Rhombus.prototype.constructor=IKRS.Tile.Rhombus,IKRS.Tile.BowTie=function(e,i,t){IKRS.Tile.call(this,e,i,t,IKRS.Girih.TILE_TYPE_BOW_TIE);var n=new IKRS.Point2(0,0),o=n,r=n,I=null;this._addVertex(o);for(var l=[0,72,72,216,72],s=0,h=0;h<l.length;h++)s+=180-l[h],(o=(n=o).clone()).x-=e,o.rotate(n,s*(Math.PI/180)),this._addVertex(o),2==h&&(I=o);IKRS.BoundingBox2.computeFromPoints(this.polygon.vertices);var a=new IKRS.Point2((I.x-r.x)/2,(I.y-r.y)/2);for(h=0;h<this.polygon.vertices.length;h++)this.polygon.vertices[h].sub(a);this.imageProperties={source:{x:.576,y:7/460,width:.412,height:150/460},destination:{xOffset:0,yOffset:0}},this._buildInnerPolygons(e),this._buildOuterPolygons()},IKRS.Tile.BowTie.prototype._buildInnerPolygons=function(e){for(var i=[1,4],t=0;t<i.length;t++){var n=i[t],o=this.getVertexAt(n).clone().scaleTowards(this.getVertexAt(n+1),.5),r=this.getVertexAt(n-1).clone().scaleTowards(this.getVertexAt(n),.5),I=this.getVertexAt(n+1).clone().scaleTowards(this.getVertexAt(n+2),.5),l=o.clone().multiplyScalar(.38),s=new IKRS.Polygon;s.addVertex(o),s.addVertex(I),s.addVertex(l),s.addVertex(r),this.innerTilePolygons.push(s)}},IKRS.Tile.BowTie.prototype._buildOuterPolygons=function(){for(var e=[0,3],i=0;i<e.length;i++){var t=e[i],n=new IKRS.Polygon;n.addVertex(this.innerTilePolygons[i].getVertexAt(0).clone()),n.addVertex(this.getVertexAt(t+2).clone()),n.addVertex(this.innerTilePolygons[i].getVertexAt(1).clone()),this.outerTilePolygons.push(n);var o=new IKRS.Polygon;o.addVertex(this.innerTilePolygons[i].getVertexAt(0).clone()),o.addVertex(this.getVertexAt(t+1).clone()),o.addVertex(this.innerTilePolygons[i].getVertexAt(3).clone()),this.outerTilePolygons.push(o)}var r=new IKRS.Polygon;r.addVertex(this.getVertexAt(0).clone()),r.addVertex(this.innerTilePolygons[0].getVertexAt(3).clone()),r.addVertex(this.innerTilePolygons[0].getVertexAt(2).clone()),r.addVertex(this.innerTilePolygons[0].getVertexAt(1).clone()),r.addVertex(this.getVertexAt(3).clone()),r.addVertex(this.innerTilePolygons[1].getVertexAt(3).clone()),r.addVertex(this.innerTilePolygons[1].getVertexAt(2).clone()),r.addVertex(this.innerTilePolygons[1].getVertexAt(1).clone()),this.outerTilePolygons.push(r)},IKRS.Tile.BowTie.prototype.computeBounds=IKRS.Tile.prototype.computeBounds,IKRS.Tile.BowTie.prototype._addVertex=IKRS.Tile.prototype._addVertex,IKRS.Tile.BowTie.prototype._translateVertex=IKRS.Tile.prototype._translateVertex,IKRS.Tile.BowTie.prototype._polygonToSVG=IKRS.Tile.prototype._polygonToSVG,IKRS.Tile.BowTie.prototype.getInnerTilePolygonAt=IKRS.Tile.prototype.getInnerTilePolygonAt,IKRS.Tile.BowTie.prototype.getOuterTilePolygonAt=IKRS.Tile.prototype.getOuterTilePolygonAt,IKRS.Tile.BowTie.prototype.getTranslatedVertex=IKRS.Tile.prototype.getTranslatedVertex,IKRS.Tile.BowTie.prototype.containsPoint=IKRS.Tile.prototype.containsPoint,IKRS.Tile.BowTie.prototype.locateEdgeAtPoint=IKRS.Tile.prototype.locateEdgeAtPoint,IKRS.Tile.BowTie.prototype.locateAdjacentEdge=IKRS.Tile.prototype.locateAdjacentEdge,IKRS.Tile.BowTie.prototype.getVertexAt=IKRS.Tile.prototype.getVertexAt,IKRS.Tile.BowTie.prototype.toSVG=IKRS.Tile.prototype.toSVG,IKRS.Tile.BowTie.prototype.constructor=IKRS.Tile.BowTie,IKRS.Tile.PenroseRhombus=function(e,i,t,n){IKRS.Tile.call(this,e,i,t,IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS),void 0===n&&(n=!0);var o=new IKRS.Point2(0,0),r=o;this._addVertex(r);for(var I=[0,36,144],l=0,s=0;s<I.length;s++)l+=180-I[s],(r=(o=r).clone()).x+=e,r.rotate(o,l*(Math.PI/180)),this._addVertex(r);var h=IKRS.BoundingBox2.computeFromPoints(this.polygon.vertices),a=new IKRS.Point2(h.getWidth()/2-(h.getWidth()-e),h.getHeight()/2);for(s=0;s<this.polygon.vertices.length;s++)this.polygon.vertices[s].add(a);this.imageProperties={source:{x:.004,y:8/460,width:.346,height:56/460},destination:{xOffset:0,yOffset:0}},this._buildInnerPolygons(n),this._buildOuterPolygons(n)},IKRS.Tile.PenroseRhombus.prototype._buildInnerPolygons=function(e){for(var i=[0,2],t=new IKRS.Polygon,n=0;n<i.length;n++){var o=new IKRS.Polygon,r=i[n],I=this.getVertexAt(r).clone().scaleTowards(this.getVertexAt(r+1),.5),l=this.getVertexAt(r+1).clone().scaleTowards(this.getVertexAt(r+2),.5),s=this.getVertexAt(r+1).clone().multiplyScalar(.28),h=this.getVertexAt(r+1).clone().multiplyScalar(.55);o.addVertex(I),o.addVertex(s),o.addVertex(l),o.addVertex(h),t.addVertex(this.getVertexAt(r).clone().scaleTowards(this.getVertexAt(r+2),.1775)),t.addVertex(s),this.innerTilePolygons.push(o)}e&&this.innerTilePolygons.push(t)},IKRS.Tile.PenroseRhombus.prototype._buildOuterPolygons=function(e){for(var i=[0,2],t=0;t<i.length;t++){var n=new IKRS.Polygon,o=i[t],r=this.getVertexAt(o).clone().scaleTowards(this.getVertexAt(o+1),.5),I=this.getVertexAt(o+1).clone().scaleTowards(this.getVertexAt(o+2),.5),l=(this.getVertexAt(o+1).clone().multiplyScalar(.28),this.getVertexAt(o+1).clone().multiplyScalar(.55));n.addVertex(r.clone()),n.addVertex(this.getVertexAt(o+1).clone()),n.addVertex(I.clone()),n.addVertex(l.clone()),this.outerTilePolygons.push(n)}if(e)for(i=[0,2],t=0;t<i.length;t++){n=new IKRS.Polygon,o=i[t];n.addVertex(this.getVertexAt(o).clone()),n.addVertex(this.getVertexAt(o).clone().scaleTowards(this.getVertexAt(o+1),.5)),n.addVertex(this.innerTilePolygons[t].getVertexAt(1).clone()),n.addVertex(this.getVertexAt(o).clone().scaleTowards(this.getVertexAt(o+2),.1775)),n.addVertex(this.innerTilePolygons[(t+1)%2].getVertexAt(1).clone()),n.addVertex(this.getVertexAt(o-1).clone().scaleTowards(this.getVertexAt(o),.5)),this.outerTilePolygons.push(n)}},IKRS.Tile.PenroseRhombus.prototype.getCenterPolygonIndex=function(){return 2},IKRS.Tile.PenroseRhombus.prototype.computeBounds=IKRS.Tile.prototype.computeBounds,IKRS.Tile.PenroseRhombus.prototype._addVertex=IKRS.Tile.prototype._addVertex,IKRS.Tile.PenroseRhombus.prototype._translateVertex=IKRS.Tile.prototype._translateVertex,IKRS.Tile.PenroseRhombus.prototype._polygonToSVG=IKRS.Tile.prototype._polygonToSVG,IKRS.Tile.PenroseRhombus.prototype.getInnerTilePolygonAt=IKRS.Tile.prototype.getInnerTilePolygonAt,IKRS.Tile.PenroseRhombus.prototype.getOuterTilePolygonAt=IKRS.Tile.prototype.getOuterTilePolygonAt,IKRS.Tile.PenroseRhombus.prototype.getTranslatedVertex=IKRS.Tile.prototype.getTranslatedVertex,IKRS.Tile.PenroseRhombus.prototype.containsPoint=IKRS.Tile.prototype.containsPoint,IKRS.Tile.PenroseRhombus.prototype.locateEdgeAtPoint=IKRS.Tile.prototype.locateEdgeAtPoint,IKRS.Tile.PenroseRhombus.prototype.locateAdjacentEdge=IKRS.Tile.prototype.locateAdjacentEdge,IKRS.Tile.PenroseRhombus.prototype.getVertexAt=IKRS.Tile.prototype.getVertexAt,IKRS.Tile.PenroseRhombus.prototype.toSVG=IKRS.Tile.prototype.toSVG,IKRS.Tile.Rhombus.prototype.constructor=IKRS.Tile.Rhombus,IKRS.Girih=function(){IKRS.Object.call(this),this.tiles=[]},IKRS.Girih.prototype.addTile=function(e){this.tiles.push(e)},IKRS.Girih.deg2rad=function(e){return e*(Math.PI/180)},IKRS.Girih.rad2deg=function(e){return 180*e/Math.PI},IKRS.Girih.MINIMAL_ANGLE=IKRS.Girih.deg2rad(18),IKRS.Girih.TILE_TYPE_UNKNOWN=-1,IKRS.Girih.TILE_TYPE_DECAGON=0,IKRS.Girih.TILE_TYPE_PENTAGON=1,IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON=2,IKRS.Girih.TILE_TYPE_RHOMBUS=3,IKRS.Girih.TILE_TYPE_BOW_TIE=4,IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS=5,IKRS.Girih.TILE_ALIGN=Array(),IKRS.Girih.DEFAULT_EDGE_LENGTH=58,IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_DECAGON]=Array(10),IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_DECAGON][0]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(104,-144),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(75,-104),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(104,-89),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(71,-99),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(52,-127),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(75,-89),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(61,-99),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-99),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(84,-61),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(84,-116),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(83,-73),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(43,-101),4*IKRS.Girih.MINIMAL_ANGLE)];for(var i=1;i<10;i++){IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_DECAGON][i]=[];for(var e=0;e<IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_DECAGON][0].length;e++){(tileAlign=IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_DECAGON][0][e].clone()).position.rotate(IKRS.Point2.ZERO_POINT,2*i*IKRS.Girih.MINIMAL_ANGLE),tileAlign.angle+=2*i*IKRS.Girih.MINIMAL_ANGLE,IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_DECAGON][i].push(tileAlign)}}IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENTAGON]=Array(5),IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENTAGON][0]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(122,-39.5),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(75,-24),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(88.5,4.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(70,-22.5),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(70,-56),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(66.5,-12.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(61,-29),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(38,-45.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(57.5,15),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(89.5,-28.5),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(61,4),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(47,-39),6*IKRS.Girih.MINIMAL_ANGLE)];for(i=1;i<5;i++){IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENTAGON][i]=[];for(e=0;e<IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENTAGON][0].length;e++){(tileAlign=IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENTAGON][0][e].clone()).position.rotate(IKRS.Point2.ZERO_POINT,4*i*IKRS.Girih.MINIMAL_ANGLE),tileAlign.angle+=4*i*IKRS.Girih.MINIMAL_ANGLE,IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENTAGON][i].push(tileAlign)}}IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON]=Array(6),IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON][0]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-133.5),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-84),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(64,-88.5),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-78),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(.5,-88.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(23.5,-72.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(41.5,-72.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(65,-55),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32.5,-99),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(.5,-55),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(55,-61),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(9,-61),2*IKRS.Girih.MINIMAL_ANGLE)],IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON][1]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(136,10.5),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(90,-4.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(104,-33.5),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(84,-5.5),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(84.5,27.5),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(81.5,-17),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(76,0),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(71.5,-43.5),-6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(104,0),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(52.5,17),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(75,-33),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(61,9),-4*IKRS.Girih.MINIMAL_ANGLE)],IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON][2]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(72,99),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(43,60),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(20,82),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(40,54.5),0),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(71,43.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(29.5,55),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(43,44.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(52.5,17),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(52.5,71.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(.5,55),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(11,55),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(49,28),0*IKRS.Girih.MINIMAL_ANGLE)];for(e=3;e<6;e++){IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON][e]=[];for(i=0;i<IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON][e-3].length;i++){(tileAlign=IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON][e-3][i].clone()).position.rotate(IKRS.Point2.ZERO_POINT,10*IKRS.Girih.MINIMAL_ANGLE),tileAlign.angle+=10*IKRS.Girih.MINIMAL_ANGLE,tileAlign.position.x+=4==e?2:1,IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON][e].push(tileAlign)}}IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_RHOMBUS]=Array(4),IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_RHOMBUS][0]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-9,116.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-9,67),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-41,72),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-8.5,61),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(23,71.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-18,55),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(0,55),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-41.5,38.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-9,82.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(23,38.5),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-32,45),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(14,45),2*IKRS.Girih.MINIMAL_ANGLE)],IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_RHOMBUS][1]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-113.5,-27.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-66.5,-12.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-81,17),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-61.5,-10.5),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-61,-44.5),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-57.5,0),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-52.5,-17),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-81,-17),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-49,27.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-29,-34),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-52,16),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-38,-27),-4*IKRS.Girih.MINIMAL_ANGLE)];for(e=2;e<4;e++){IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_RHOMBUS][e]=[];for(i=0;i<IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_RHOMBUS][e-2].length;i++){(tileAlign=IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_RHOMBUS][e-2][i].clone()).position.rotate(IKRS.Point2.ZERO_POINT,10*IKRS.Girih.MINIMAL_ANGLE),tileAlign.angle+=10*IKRS.Girih.MINIMAL_ANGLE,IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_RHOMBUS][e].push(tileAlign)}}IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE]=Array(6),IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE][0]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-99.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-50.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(64,-55),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-45),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(0,-55),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(41,-38),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(23,-38),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(64,-21),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(32,-65.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(55,-28),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(9,-28),2*IKRS.Girih.MINIMAL_ANGLE)],IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE][1]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(136,44.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(90,29),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(104,0),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(84.5,27.5),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(84.5,61.5),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(81,17),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(75.5,34),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(104,34),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(72,-10.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(52,51),-4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(75,0),-2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(62,44),-4*IKRS.Girih.MINIMAL_ANGLE)],IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE][2]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-32,99.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-3.5,59),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(20,82),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(0,55),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-32,44.25),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-3.5,44.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(11,55),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(39.5,55),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-12,72),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-9,28),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(29,55),4*IKRS.Girih.MINIMAL_ANGLE)];for(e=3;e<6;e++){IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE][e]=[];for(i=0;i<IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE][e-3].length;i++){(tileAlign=IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE][e-3][i].clone()).position.rotate(IKRS.Point2.ZERO_POINT,10*IKRS.Girih.MINIMAL_ANGLE),tileAlign.angle+=10*IKRS.Girih.MINIMAL_ANGLE,IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_BOW_TIE][e].push(tileAlign)}}IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS]=Array(4),IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS][0]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-24,106.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-24,57),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-56,62),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-23.5,51),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(8,61.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-32,45),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-15,45),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-56.5,28.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-24,72.5),4*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(8,28.5),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-47,35),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-1,35),2*IKRS.Girih.MINIMAL_ANGLE)],IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS][1]=[new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_DECAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-81.5,-72.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENTAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-52.5,-32.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-81,-17),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-48.5,-27.5),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_IRREGULAR_HEXAGON,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-81,-17),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-52.5,-16.5),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-38,-27),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-61.5,-44),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-61,10),6*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_BOW_TIE,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-9,-27),8*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-59,0),0*IKRS.Girih.MINIMAL_ANGLE),new IKRS.TileAlign(IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS,IKRS.Girih.DEFAULT_EDGE_LENGTH,new IKRS.Point2(-20,-27),-2*IKRS.Girih.MINIMAL_ANGLE)];for(e=2;e<4;e++){IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS][e]=[];for(i=0;i<IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS][e-2].length;i++){var tileAlign;(tileAlign=IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS][e-2][i].clone()).position.rotate(IKRS.Point2.ZERO_POINT,10*IKRS.Girih.MINIMAL_ANGLE),tileAlign.angle+=10*IKRS.Girih.MINIMAL_ANGLE,IKRS.Girih.TILE_ALIGN[IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS][e].push(tileAlign)}}IKRS.Girih.prototype.toSVG=function(e,i,t){var n=!1;void 0!==t&&t||(t=[],n=!0),void 0!==e&&void 0!==e.indent&&t.push(e.indent),t.push('<?xml version="1.0" encoding="UTF-8"?>\n'),t.push('<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n'),t.push('<svg xmlns="http://www.w3.org/2000/svg" \n'),t.push('     xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" \n'),t.push('     version="1.1" baseProfile="full" \n'),t.push('     height="'),t.push(e.height),t.push('"'),t.push('     width="'),t.push(e.width),t.push('">\n');var o=e.indent;e.indent+="    ";for(var r=0;r<this.tiles.length;r++)this.tiles[r].toSVG(e,i,t);return e.indent=o,void 0!==e&&void 0!==e.indent&&t.push(e.indent),t.push("</svg>\n"),n?t:t.join("")},IKRS.Girih.prototype.constructor=IKRS.Girih,IKRS.GirihCanvasHandler=function(e){IKRS.Object.call(this),this.imageObject=e,this.canvasWidth=1024,this.canvasHeight=768,this.canvas=document.getElementById("girih_canvas"),(this.canvas.girihCanvasHandler=this).context=this.canvas.getContext("2d"),this.drawOffset=new IKRS.Point2(512,384),this.zoomFactor=1,this.girih=new IKRS.Girih,this.drawProperties={drawCoordinateSystem:!1,drawBoxes:!1,drawOutlines:!0,drawTexture:!0,drawInnerPolygons:!0,innerRandomColorFill:!1,outerRandomColorFill:!1,backgroundColor:"#ffffff"},this.properties={allowPenroseTile:!0,drawPenroseCenterPolygon:!0},this.adjacentTileOptionPointer=0,this.canvas.onmousedown=this.mouseDownHandler,this.canvas.onmouseup=this.mouseUpHandler,this.canvas.onmousemove=this.mouseMoveHandler,this.canvas.addEventListener?this.canvas.addEventListener("DOMMouseScroll",this.mouseWheelHandler,!1):this.canvas.onmousewheel=document.onmousewheel=mouseWheelHandler,window.addEventListener("keydown",this.keyDownHandler,!1)},IKRS.GirihCanvasHandler.prototype.setTextureImage=function(e,i){this.imageObject=e,i&&this.redraw()},IKRS.GirihCanvasHandler.prototype._translateMouseEventToRelativePosition=function(e,i){var t=e.getBoundingClientRect(),n=i.clientX-t.left-e.clientLeft+e.scrollLeft,o=i.clientY-t.top-e.clientTop+e.scrollTop,r=(n-this.drawOffset.x)/this.zoomFactor,I=(o-this.drawOffset.y)/this.zoomFactor;return new IKRS.Point2(r,I)},IKRS.GirihCanvasHandler.prototype.mouseWheelHandler=function(e){var i=0;e||(e=window.event),e.wheelDelta?i=e.wheelDelta/120:e.detail&&(i=-e.detail/3),i&&(i<0?this.girihCanvasHandler.decreaseZoomFactor(!0):this.girihCanvasHandler.increaseZoomFactor(!0)),e.preventDefault&&e.preventDefault(),e.returnValue=!1},IKRS.GirihCanvasHandler.prototype.mouseDownHandler=function(e){var i=this.girihCanvasHandler._translateMouseEventToRelativePosition(this,e),t=this.girihCanvasHandler._locateTileAtPoint(i);if(-1!=t){var n=null,o=null,r=this.girihCanvasHandler._locateHoveredTile();if(-1!=r&&5<(n=this.girihCanvasHandler.girih.tiles[r]).position.distanceTo(i)){var I=n.computeBounds();o=this.girihCanvasHandler._resolveCurrentAdjacentTilePreset(n.tileType,n.polygon.vertices,n.position,n.angle,I,{unselectedEdgeColor:"#000000",selectedEdgeColor:"#e80088"},n.imageProperties,this.girihCanvasHandler.imageObject,n._props.highlightedEdgeIndex,this.girihCanvasHandler.drawProperties.drawOutlines)}o?this.girihCanvasHandler._performAddCurrentAdjacentPresetTile():(this.girihCanvasHandler._clearSelection(),this.girihCanvasHandler.girih.tiles[t]._props.selected=!0,this.girihCanvasHandler.redraw())}},IKRS.GirihCanvasHandler.prototype.mouseUpHandler=function(e){},IKRS.GirihCanvasHandler.prototype.mouseMoveHandler=function(e){var i=this.girihCanvasHandler._locateHoveredTile(),t=-1;-1!=i&&(t=this.girihCanvasHandler.girih.tiles[i]._props.highlightedEdgeIndex);var n=this.girihCanvasHandler._translateMouseEventToRelativePosition(this,e);this.girihCanvasHandler._clearHovered();var o=this.girihCanvasHandler._locateTileAtPoint(n);if(-1==o)return DEBUG("[mouseMoved] CLEARED hoverTileIndex="+o),void(i!=o&&this.girihCanvasHandler.redraw());var r=this.girihCanvasHandler.girih.tiles[o];r._props.hovered=!0;var I=r.locateEdgeAtPoint(n,r.size/2*this.girihCanvasHandler.zoomFactor);DEBUG("[mouseMoved] hoverTileIndex="+o+", highlightedEdgeIndex="+I+", hoverTile.position="+r.position.toString()+", hoverTile.angle="+_angle2constant(r.angle)),r._props.highlightedEdgeIndex=I,i==o&&t==I||this.girihCanvasHandler.redraw()},IKRS.GirihCanvasHandler.prototype.keyDownHandler=function(e){39==e.keyCode||68==e.keyCode?(this.girihCanvasHandler.adjacentTileOptionPointer++,this.girihCanvasHandler.redraw()):37==e.keyCode||65==e.keyCode?(this.girihCanvasHandler.adjacentTileOptionPointer--,this.girihCanvasHandler.redraw()):13==e.keyCode||32==e.keyCode?this.girihCanvasHandler._performAddCurrentAdjacentPresetTile():46==e.keyCode?this.girihCanvasHandler._performDeleteSelectedTile():79==e.keyCode?(this.girihCanvasHandler.drawProperties.drawOutlines=!this.girihCanvasHandler.drawProperties.drawOutlines,this.girihCanvasHandler.redraw()):84==e.keyCode?(this.girihCanvasHandler.drawProperties.drawTextures=!this.girihCanvasHandler.drawProperties.drawTextures,this.girihCanvasHandler.redraw()):69==e.keyCode&&this.girihCanvasHandler._exportSVG()},IKRS.GirihCanvasHandler.prototype._locateSelectedTile=function(){for(var e=0;e<this.girih.tiles.length;e++)if(this.girih.tiles[e]._props.selected)return e;return-1},IKRS.GirihCanvasHandler.prototype._locateHoveredTile=function(){for(var e=0;e<this.girih.tiles.length;e++)if(this.girih.tiles[e]._props.hovered)return e;return-1},IKRS.GirihCanvasHandler.prototype._clearSelection=function(){for(var e=0;e<this.girih.tiles.length;e++)this.girih.tiles[e]._props.selected=!1},IKRS.GirihCanvasHandler.prototype._clearHovered=function(){for(var e=0;e<this.girih.tiles.length;e++)this.girih.tiles[e]._props.hovered=!1,this.girih.tiles[e]._props.highlightedEdgeIndex=-1},IKRS.GirihCanvasHandler.prototype._resolveCurrentAdjacentTilePreset=function(e,i,t,n,o,r,I,l,s,h){if(i&&-1!=s&&IKRS.Girih.TILE_ALIGN[e]&&IKRS.Girih.TILE_ALIGN[e][s]){var a=IKRS.Girih.TILE_ALIGN[e][s];if(!a||0==a.length)return null;var R=this.adjacentTileOptionPointer%a.length;R<0&&(R=a.length+R);var E=a[R].createTile();return E.position.add(t),E.position.rotate(t,n),E.angle+=n,E}},IKRS.GirihCanvasHandler.prototype._performAddCurrentAdjacentPresetTile=function(){var e=this._locateHoveredTile();if(-1!=e){var i=this.girih.tiles[e],t=i.computeBounds(),n=this._resolveCurrentAdjacentTilePreset(i.tileType,i.polygon.vertices,i.position,i.angle,t,{unselectedEdgeColor:"#000000",selectedEdgeColor:"#e80088"},i.imageProperties,this.imageObject,i._props.highlightedEdgeIndex,this.drawProperties.drawOutlines);if(n)if(n.tileType!=IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS||this.getProperties().allowPenroseTile){var o,r,I,l=i.getTranslatedVertex(i._props.highlightedEdgeIndex),s=i.getTranslatedVertex(i._props.highlightedEdgeIndex+1),h=n.locateAdjacentEdge(l,s,5);if(-1!=h?(o=n.getTranslatedVertex(h),r=n.getTranslatedVertex(h+1)):-1!=(h=n.locateAdjacentEdge(s,l,5))&&(o=n.getTranslatedVertex(h+1),r=n.getTranslatedVertex(h)),-1!=h){I=[o.clone().sub(l),r.clone().sub(s)];for(var a=IKRS.Point2.ZERO_POINT.clone(),R=0;R<I.length;R++)a.add(I[R]);a.x/=I.length,a.y/=I.length,n.position.sub(a)}this.addTile(n),this.redraw()}else DEBUG("Penrose tile not allowed.")}},IKRS.GirihCanvasHandler.prototype._performDeleteSelectedTile=function(){var e=this._locateSelectedTile();-1!=e&&(this.girih.tiles.splice(e,1),this.redraw())},IKRS.GirihCanvasHandler.prototype.addTile=function(e){e._props={selected:!1,hovered:!1,highlightedEdgeIndex:-1},this.girih.addTile(e)},IKRS.GirihCanvasHandler.prototype._locateTileAtPoint=function(e){for(var i=this.girih.tiles.length-1;0<=i;i--)if((this.girih.tiles[i].tileType!=IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS||this.getProperties().allowPenroseTile)&&this.girih.tiles[i].containsPoint(e))return i;return-1},IKRS.GirihCanvasHandler.prototype._drawTile=function(e){if(e.tileType!=IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS||this.getProperties().allowPenroseTile){var i=e.computeBounds();this.drawProperties.drawBoxes&&this._drawBoundingBox(e.position,i,e.angle),this._drawPolygonFromPoints(e.polygon.vertices,e.position,e.angle,i,{unselectedEdgeColor:"#000000",selectedEdgeColor:"#e80088",fillColor:null},e.imageProperties,this.imageObject,e._props.highlightedEdgeIndex,this.drawProperties.drawOutlines),this.drawProperties.drawInnerPolygons&&(this._drawInnerTilePolygons(e),this._drawOuterTilePolygons(e)),(this.drawProperties.drawOutlines||e._props.selected)&&this._drawCrosshairAt(e.position,e._props.selected)}},IKRS.GirihCanvasHandler.prototype._drawPolygonFromPoints=function(e,i,t,n,o,r,I,l,s){if(e){this.context.save(),this.context.beginPath();var h=e[0].clone();h.rotate(IKRS.Point2.ZERO_POINT,t);var a=h.clone();this.context.moveTo(h.x*this.zoomFactor+this.drawOffset.x+i.x*this.zoomFactor,h.y*this.zoomFactor+this.drawOffset.y+i.y*this.zoomFactor);for(var R=new IKRS.BoundingBox2(h.x,h.y,h.x,h.y),E=1;E<e.length;E++)h.set(e[E]),h.rotate(IKRS.Point2.ZERO_POINT,t),this.context.lineTo(h.x*this.zoomFactor+this.drawOffset.x+i.x*this.zoomFactor,h.y*this.zoomFactor+this.drawOffset.y+i.y*this.zoomFactor),R.xMin=Math.min(h.x,R.xMin),R.xMax=Math.max(h.x,R.xMax),R.yMin=Math.min(h.y,R.yMin),R.yMax=Math.max(h.y,R.yMax);if(this.context.lineTo(a.x*this.zoomFactor+this.drawOffset.x+i.x*this.zoomFactor,a.y*this.zoomFactor+this.drawOffset.y+i.y*this.zoomFactor),this.context.closePath(),this.drawProperties.drawTextures&&r&&I){var S=new IKRS.BoundingBox2(r.source.x*I.width,(r.source.x+r.source.width)*I.width,r.source.y*I.height,(r.source.y+r.source.height)*I.height),T=new IKRS.Point2(n.getWidth()/S.getWidth(),n.getHeight()/S.getHeight());this.context.clip();var K=this.drawOffset.x+i.x*this.zoomFactor+n.xMin*this.zoomFactor,g=this.drawOffset.y+i.y*this.zoomFactor+n.yMin*this.zoomFactor,G=(n.getWidth()+r.destination.xOffset*I.width*T.x)*this.zoomFactor,_=(n.getHeight()+r.destination.yOffset*I.height*T.y)*this.zoomFactor;this.context.translate(K+G/2,g+_/2),this.context.rotate(t);var d=-n.getWidth()/2*this.zoomFactor,p=-n.getHeight()/2*this.zoomFactor;this.context.drawImage(I,r.source.x*I.width,r.source.y*I.height,r.source.width*I.width,r.source.height*I.height,d+r.destination.xOffset*I.width*T.x*.5*this.zoomFactor,p+r.destination.yOffset*I.height*T.y*.5*this.zoomFactor,(n.getWidth()-r.destination.xOffset*I.width*T.x)*this.zoomFactor,(n.getHeight()-r.destination.yOffset*I.height*T.y)*this.zoomFactor)}o.fillColor&&(this.context.fillStyle=o.fillColor,this.context.fill()),s&&o.unselectedEdgeColor&&(this.context.lineWidth=1,this.context.strokeStyle=o.unselectedEdgeColor,this.context.stroke()),this.context.restore()}},IKRS.GirihCanvasHandler.prototype._drawHighlightedPolygonEdge=function(e,i,t,n,o,r,I,l,s){if(e&&-1!=l){this.context.save();var h=e[l].clone(),a=e[l+1<e.length?l+1:0].clone();h.rotate(IKRS.Point2.ZERO_POINT,t),a.rotate(IKRS.Point2.ZERO_POINT,t),this.context.beginPath(),this.context.lineTo(h.x*this.zoomFactor+this.drawOffset.x+i.x*this.zoomFactor,h.y*this.zoomFactor+this.drawOffset.y+i.y*this.zoomFactor),this.context.lineTo(a.x*this.zoomFactor+this.drawOffset.x+i.x*this.zoomFactor,a.y*this.zoomFactor+this.drawOffset.y+i.y*this.zoomFactor),this.context.closePath(),this.context.strokeStyle=o.selectedEdgeColor,this.context.lineWidth=3,this.context.stroke(),this.context.restore()}},IKRS.GirihCanvasHandler.prototype._drawPreviewTileAtHighlightedPolygonEdge=function(e,i,t,n,o,r,I,l,s,h){var a=this._resolveCurrentAdjacentTilePreset(e,i,t,n,o,r,I,l,s,h);a&&(this.context.globalAlpha=.5,this._drawPolygonFromPoints(a.polygon.vertices,a.position,a.angle,a.computeBounds(),{unselectedEdgeColor:"#888888",selectedEdgeColor:null,fillColor:null},a.imageProperties,this.imageObject,-1,!0),this.context.globalAlpha=1)},IKRS.GirihCanvasHandler.prototype._drawCrosshairAt=function(e,i){this.context.strokeStyle=i?"#FF0000":"#000000",this.context.beginPath();this.context.arc(e.x*this.zoomFactor+this.drawOffset.x,e.y*this.zoomFactor+this.drawOffset.y,5,0,2*Math.PI,!1),this.context.stroke(),this.context.closePath()},IKRS.GirihCanvasHandler.prototype._drawBoundingBox=function(e,i,t){var n=[i.getLeftUpperPoint(),i.getRightUpperPoint(),i.getRightLowerPoint(),i.getLeftLowerPoint()];this.context.strokeStyle="#c8c8ff",this._drawPolygonFromPoints(n,e,t,i,{unselectedEdgeColor:"#c8c8ff",selectedEdgeColor:"#c8c8ff",fillColor:null},null,null,-1,!0),this.context.stroke()},IKRS.GirihCanvasHandler.prototype._drawCoordinateSystem=function(){this.context.strokeStyle="#c8c8c8",this.context.beginPath(),this.context.moveTo(this.drawOffset.x,0),this.context.lineTo(this.drawOffset.x,this.canvasHeight),this.context.moveTo(0,this.drawOffset.y),this.context.lineTo(this.canvasWidth,this.drawOffset.y),this.context.stroke(),this.context.closePath()},IKRS.GirihCanvasHandler.prototype._drawInnerTilePolygons=function(e){for(var i=0;i<e.innerTilePolygons.length;i++)(e.tileType!=IKRS.Girih.TILE_TYPE_PENROSE_RHOMBUS||this.getProperties().drawPenroseCenterPolygon||i!=e.getCenterPolygonIndex())&&this._drawInnerTile(e,i)},IKRS.GirihCanvasHandler.prototype._drawOuterTilePolygons=function(e){for(var i=0;i<e.outerTilePolygons.length;i++){var t=e.outerTilePolygons[i],n=null;this.drawProperties.outerRandomColorFill&&(n="rgba("+Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random())+",0.5)"),this._drawPolygonFromPoints(t.vertices,e.position,e.angle,IKRS.BoundingBox2.computeFromPoints(t.vertices),{unselectedEdgeColor:null,selectedEdgeColor:null,fillColor:n},null,null,-1,!0)}},IKRS.GirihCanvasHandler.prototype._drawInnerTile=function(e,i){var t=e.innerTilePolygons[i],n=null;this.drawProperties.innerRandomColorFill&&(n="rgba("+Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random())+",0.5)"),this._drawPolygonFromPoints(t.vertices,e.position,e.angle,IKRS.BoundingBox2.computeFromPoints(t.vertices),{unselectedEdgeColor:"#00a800",selectedEdgeColor:"#00a800",fillColor:n},null,null,-1,!0)},IKRS.GirihCanvasHandler.prototype._drawTiles=function(){for(var e=0;e<this.girih.tiles.length;e++)this._drawTile(this.girih.tiles[e]);var i=this._locateHoveredTile();if(-1!=i){var t=this.girih.tiles[i],n=t.computeBounds();this._drawHighlightedPolygonEdge(t.polygon.vertices,t.position,t.angle,n,{unselectedEdgeColor:"#000000",selectedEdgeColor:"#ffaf30",fillColor:null},t.imageProperties,this.imageObject,t._props.highlightedEdgeIndex,this.drawProperties.drawOutlines),this._drawPreviewTileAtHighlightedPolygonEdge(t.tileType,t.polygon.vertices,t.position,t.angle,n,{unselectedEdgeColor:null,selectedEdgeColor:null,fillColor:null},t.imageProperties,this.imageObject,t._props.highlightedEdgeIndex,this.drawProperties.drawOutlines)}},IKRS.GirihCanvasHandler.prototype.getDrawProperties=function(){return this.drawProperties},IKRS.GirihCanvasHandler.prototype.getProperties=function(){return this.properties},IKRS.GirihCanvasHandler.prototype.redraw=function(){this.context.fillStyle=this.getDrawProperties().backgroundColor,this.context.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.getDrawProperties().drawCoordinateSystem&&this._drawCoordinateSystem(),this._drawTiles()},IKRS.GirihCanvasHandler.prototype._drawCircleTest=function(){var e=new IKRS.Circle(IKRS.Point2.ZERO_POINT,50),i=new IKRS.Circle(new IKRS.Point2(50,50),75);this._drawCircleIntersections(e,i)},IKRS.GirihCanvasHandler.prototype._drawCircleIntersections=function(e,i){var t=e.computeIntersectionPoints(i);t&&(this._drawCrosshairAt(t.pointA,!1),this._drawCrosshairAt(t.pointB,!1)),this._drawCircle(e),this._drawCircle(i)},IKRS.GirihCanvasHandler.prototype._drawCircle=function(e){this.context.strokeStyle="#FF0000",this.context.beginPath(),this.context.arc(e.center.x*this.zoomFactor+this.drawOffset.x,e.center.y*this.zoomFactor+this.drawOffset.y,e.radius*this.zoomFactor,0,2*Math.PI),this.context.stroke()},IKRS.GirihCanvasHandler.prototype._drawLineIntersectionTest=function(){var e=new IKRS.Line2(new IKRS.Point2(10,10),new IKRS.Point2(120,120)),i=new IKRS.Line2(new IKRS.Point2(100,30),new IKRS.Point2(10,150));this._drawLine(e),this._drawLine(i);var t=e.computeEdgeIntersection(i);t?this._drawCrosshairAt(t,!1):DEBUG("No intersection found.")},IKRS.GirihCanvasHandler.prototype._drawLine=function(e){this.context.beginPath(),this.context.moveTo(e.pointA.x*this.zoomFactor+this.drawOffset.x,e.pointA.y*this.zoomFactor+this.drawOffset.y),this.context.lineTo(e.pointB.x*this.zoomFactor+this.drawOffset.x,e.pointB.y*this.zoomFactor+this.drawOffset.y),this.context.strokeStyle="#0000FF",this.context.stroke()},IKRS.GirihCanvasHandler.prototype.increaseZoomFactor=function(e){this.zoomFactor*=1.2,e&&this.redraw()},IKRS.GirihCanvasHandler.prototype.decreaseZoomFactor=function(e){this.zoomFactor/=1.2,e&&this.redraw()},IKRS.GirihCanvasHandler.prototype.getSVG=function(e,i){var t=[];return void 0===e&&(e={}),void 0===e.indent&&(e.indent=""),e.width=this.canvasWidth,e.height=this.canvasHeight,"fill-opacity:0.0; fill:white; stroke:green; stroke-width:1;",this.girih.toSVG(e,"fill-opacity:0.0; fill:white; stroke:green; stroke-width:1;",t),t.join("")},IKRS.GirihCanvasHandler.prototype._exportSVG=function(e,i){var t=this.getSVG();saveTextFile(t,"girih.svg","image/svg+xml")},IKRS.GirihCanvasHandler.prototype.constructor=IKRS.GirihCanvasHandler,ImageFileReader={readTextureImage:function(){var e=document.forms.girih_form.elements.custom_texture_file;ImageFileReader._readImageFile(e,function(e){girihCanvasHandler.setTextureImage(e,!0)})},_readImageFile:function(e,n){if(e.files&&e.files[0]){var i=new FileReader;i.onload=function(e){var i=e.target.result,t=new Image;t.onload=function(e){n(t)},t.src=i},i.onerror=function(e){console.error("File could not be read! Code "+e.target.error.code),window.alert("File could not be read! Code "+e.target.error.code)},i.readAsDataURL(e.files[0])}}};var girih=new IKRS.Girih,girihCanvasHandler=null,defaultTextureImage=null;function onLoad(){(defaultTextureImage=new Image).onload=function(){girihCanvasHandler=new IKRS.GirihCanvasHandler(defaultTextureImage);var e=IKRS.Girih.DEFAULT_EDGE_LENGTH,i=new IKRS.Tile.PenroseRhombus(e,new IKRS.Point2(276.5385,49.2873),0);girihCanvasHandler.addTile(i),_makeTest_Decagon_BowTie(e),_makeTest_Pentagon(e),_makeTest_IrregularHexagon(e),_makeTest_Rhombus(e),girihCanvasHandler.zoomFactor=.75,girihCanvasHandler.getDrawProperties().drawBoxes=!1,girihCanvasHandler.getDrawProperties().drawOutlines=!1,girihCanvasHandler.getDrawProperties().drawTextures=!1,girihCanvasHandler.getDrawProperties().drawInnerPolygons=!0,girihCanvasHandler.getDrawProperties().outerRandomColorFill=!1,girihCanvasHandler.getDrawProperties().innerRandomColorFill=!1,girihCanvasHandler.getDrawProperties().backgroundColor="#ffffff",girihCanvasHandler.getProperties().allowPenroseTile=!0,girihCanvasHandler.drawOffset.setXY(200,200);var t=function(){resizeCanvas(girihCanvasHandler.canvas,girihCanvasHandler.context,{fullSize:!0},function(e,i){console.log("canvas resized. w="+e+",h="+i),girihCanvasHandler.canvasWidth=e,girihCanvasHandler.canvasHeight=i,girihCanvasHandler.drawOffset.setXY(e/2,i/1.7)}),redrawGirih()};window.addEventListener("resize",t),t()},defaultTextureImage.src="js/girih_frontpage/img/500px-Girih_tiles.Penrose_compatible_extended.png"}function _displayTileAlign(e,i){var t=new IKRS.Point2(i.position.x-e.position.x,i.position.y-e.position.y),n=e.angle+i.angle;DEBUG("[tileAlign] new IKRS.TileAlign( IKRS.Girih.DEFAULT_EDGE_LENGTH,\n                                new IKRS.Point2( "+t.x+", "+t.y+"),\n                                "+_angle2constant(n)+" );\n")}function _angle2constant(e){var i=Math.floor(e/IKRS.Girih.MINIMAL_ANGLE),t=e%IKRS.Girih.MINIMAL_ANGLE,n="";return n=0==i?"0":i+"*IKRS.Girih.MINIMAL_ANGLE",0!=t&&(0==i?n=""+t:n+=0<t?" + "+t:" - "+Math.abs(t)),n}function _makeTest_Decagon_BowTie(e){var i=new IKRS.Tile.Decagon(e,new IKRS.Point2(300,300),0),t=(new IKRS.Tile.BowTie(e,new IKRS.Point2(333,200),0),new IKRS.Tile.BowTie(e,new IKRS.Point2(386,238),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.Tile.BowTie(e,new IKRS.Point2(386,238),2*IKRS.Girih.MINIMAL_ANGLE),new IKRS.Tile.BowTie(e,new IKRS.Point2(385,184),0));t.position.setXY(57.7319,110.9594),girihCanvasHandler.addTile(i),girihCanvasHandler.addTile(t),_displayTileAlign(i,t)}function _makeTest_Pentagon(e){var i=new IKRS.Tile.Pentagon(e,new IKRS.Point2(479,52),0);girihCanvasHandler.addTile(i)}function _makeTest_IrregularHexagon(e){var i=new IKRS.Tile.IrregularHexagon(e,new IKRS.Point2(151.577,-33.4546),0);girihCanvasHandler.addTile(i)}function _makeTest_Rhombus(e){var i=new IKRS.Tile.Rhombus(e,new IKRS.Point2(18.2,328),0);girihCanvasHandler.addTile(i)}function increaseZoom(){girihCanvasHandler.zoomFactor*=1.2,redrawGirih()}function decreaseZoom(){girihCanvasHandler.zoomFactor/=1.2,redrawGirih()}function moveLeft(){girihCanvasHandler.drawOffset.x+=50,redrawGirih()}function moveRight(){girihCanvasHandler.drawOffset.x-=50,redrawGirih()}function moveUp(){girihCanvasHandler.drawOffset.y+=50,redrawGirih()}function moveDown(){girihCanvasHandler.drawOffset.y-=50,redrawGirih()}function rotateLeft(){rotateByAmount(-IKRS.Girih.MINIMAL_ANGLE)}function rotateRight(){rotateByAmount(IKRS.Girih.MINIMAL_ANGLE)}function rotateByAmount(e){var i=girihCanvasHandler._locateSelectedTile();if(-1!=i){var t=girihCanvasHandler.girih.tiles[i];if(document.forms.rotation_form.elements.rotate_all.checked)for(var n=0;n<girihCanvasHandler.girih.tiles.length;n++){var o=girihCanvasHandler.girih.tiles[n];o.position.rotate(t.position,e),o.angle+=e}else t.angle+=e;DEBUG(IKRS.Girih.rad2deg(t.angle)+"&deg;"),redrawGirih()}else DEBUG("No tile selected.")}function redrawGirih(){girihCanvasHandler.getDrawProperties().drawBoxes=!1,girihCanvasHandler.getDrawProperties().drawOutlines=!0,girihCanvasHandler.getDrawProperties().drawTextures=!1,girihCanvasHandler.getDrawProperties().drawInnerPolygons=!0,girihCanvasHandler.getDrawProperties().outerRandomColorFill=!1,girihCanvasHandler.getDrawProperties().innerRandomColorFill=!1,girihCanvasHandler.getProperties().allowPenroseTile=!0,girihCanvasHandler.redraw()}function DEBUG(e){}function exportSVG(){var e=girihCanvasHandler.getSVG({indent:""},null);document.getElementById("svg_preview").innerHTML=e}window.addEventListener("load",onLoad);